<app-page-title
  [title]="isEditing() ? 'Editar Atleta' : 'Novo Atleta'"
  isCrud
  (cancel)="onCancel()"
  (save)="onSubmit()"
  (delete)="onDelete()"
></app-page-title>

<div class="atleta-crud-container">
  @if (loading()) {
    <div class="loading-container">
      <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
      <p>{{ isEditing() ? 'Carregando atleta...' : 'Salvando...' }}</p>
    </div>
  } @else {
    <form [formGroup]="form" (ngSubmit)="onSubmit()">

      <!-- Dados Pessoais -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>person</mat-icon>
            Dados Pessoais
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- Nome do Atleta -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Nome do Atleta</mat-label>
              <input matInput formControlName="nomeAtleta" placeholder="Nome completo do atleta">
              <mat-icon matSuffix>person</mat-icon>
              @if (form.get('nomeAtleta')?.invalid && form.get('nomeAtleta')?.touched) {
                <mat-error>{{ getErrorMessage('nomeAtleta') }}</mat-error>
              }
            </mat-form-field>

            <!-- Data de Nascimento -->
            <mat-form-field appearance="outline">
              <mat-label>Data de Nascimento</mat-label>
              <input matInput type="date" formControlName="dataNascimento">
              <mat-icon matSuffix>cake</mat-icon>
              @if (form.get('dataNascimento')?.invalid && form.get('dataNascimento')?.touched) {
                <mat-error>{{ getErrorMessage('dataNascimento') }}</mat-error>
              }
            </mat-form-field>

            <!-- Sexo -->
            <mat-form-field appearance="outline">
              <mat-label>Sexo</mat-label>
              <mat-select formControlName="sexo">
                <mat-option value="M">Masculino</mat-option>
                <mat-option value="F">Feminino</mat-option>
              </mat-select>
              <mat-icon matSuffix>wc</mat-icon>
              @if (form.get('sexo')?.invalid && form.get('sexo')?.touched) {
                <mat-error>{{ getErrorMessage('sexo') }}</mat-error>
              }
            </mat-form-field>

            <!-- Categoria -->
            <mat-form-field appearance="outline">
              <mat-label>Categoria</mat-label>
              <input matInput formControlName="categoria">
              <mat-icon matSuffix>category</mat-icon>
            </mat-form-field>

            <!-- Nacionalidade -->
            <mat-form-field appearance="outline">
              <mat-label>Nacionalidade</mat-label>
              <input matInput formControlName="nacionalidade">
              <mat-icon matSuffix>flag</mat-icon>
            </mat-form-field>

            <!-- Naturalidade -->
            <mat-form-field appearance="outline">
              <mat-label>Naturalidade</mat-label>
              <input matInput formControlName="naturalidade">
              <mat-icon matSuffix>place</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Documentos -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>description</mat-icon>
            Documentos
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- CPF -->
            <mat-form-field appearance="outline">
              <mat-label>CPF</mat-label>
              <input matInput formControlName="cpf" placeholder="000.000.000-00">
              <mat-icon matSuffix>badge</mat-icon>
              @if (form.get('cpf')?.invalid && form.get('cpf')?.touched) {
                <mat-error>{{ getErrorMessage('cpf') }}</mat-error>
              }
            </mat-form-field>

            <!-- RG -->
            <mat-form-field appearance="outline">
              <mat-label>RG</mat-label>
              <input matInput formControlName="rg">
              <mat-icon matSuffix>credit_card</mat-icon>
            </mat-form-field>

            <!-- Órgão Expedidor -->
            <mat-form-field appearance="outline">
              <mat-label>Órgão Expedidor</mat-label>
              <input matInput formControlName="rgOrgao" placeholder="SSP, PC, etc.">
              <mat-icon matSuffix>corporate_fare</mat-icon>
            </mat-form-field>

            <!-- Estado -->
            <mat-form-field appearance="outline">
              <mat-label>Estado Expedidor</mat-label>
              <mat-select formControlName="rgEstado">
                <mat-option value="AC">Acre</mat-option>
                <mat-option value="AL">Alagoas</mat-option>
                <mat-option value="AP">Amapá</mat-option>
                <mat-option value="AM">Amazonas</mat-option>
                <mat-option value="BA">Bahia</mat-option>
                <mat-option value="CE">Ceará</mat-option>
                <mat-option value="DF">Distrito Federal</mat-option>
                <mat-option value="ES">Espírito Santo</mat-option>
                <mat-option value="GO">Goiás</mat-option>
                <mat-option value="MA">Maranhão</mat-option>
                <mat-option value="MT">Mato Grosso</mat-option>
                <mat-option value="MS">Mato Grosso do Sul</mat-option>
                <mat-option value="MG">Minas Gerais</mat-option>
                <mat-option value="PA">Pará</mat-option>
                <mat-option value="PB">Paraíba</mat-option>
                <mat-option value="PR">Paraná</mat-option>
                <mat-option value="PE">Pernambuco</mat-option>
                <mat-option value="PI">Piauí</mat-option>
                <mat-option value="RJ">Rio de Janeiro</mat-option>
                <mat-option value="RN">Rio Grande do Norte</mat-option>
                <mat-option value="RS">Rio Grande do Sul</mat-option>
                <mat-option value="RO">Rondônia</mat-option>
                <mat-option value="RR">Roraima</mat-option>
                <mat-option value="SC">Santa Catarina</mat-option>
                <mat-option value="SP">São Paulo</mat-option>
                <mat-option value="SE">Sergipe</mat-option>
                <mat-option value="TO">Tocantins</mat-option>
              </mat-select>
            </mat-form-field>

            <!-- Certidão de Nascimento -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Certidão de Nascimento</mat-label>
              <input matInput formControlName="certidaoNascimento">
              <mat-icon matSuffix>assignment</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Endereço -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>home</mat-icon>
            Endereço
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- CEP -->
            <mat-form-field appearance="outline">
              <mat-label>CEP</mat-label>
              <input matInput formControlName="cep" placeholder="00000-000">
              <mat-icon matSuffix>local_post_office</mat-icon>
              @if (form.get('cep')?.invalid && form.get('cep')?.touched) {
                <mat-error>{{ getErrorMessage('cep') }}</mat-error>
              }
            </mat-form-field>

            <!-- Logradouro -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Logradouro</mat-label>
              <input matInput formControlName="logradouro" placeholder="Rua, Avenida, etc.">
              <mat-icon matSuffix>add_road</mat-icon>
            </mat-form-field>

            <!-- Número -->
            <mat-form-field appearance="outline">
              <mat-label>Número</mat-label>
              <input matInput formControlName="numero">
              <mat-icon matSuffix>tag</mat-icon>
            </mat-form-field>

            <!-- Complemento -->
            <mat-form-field appearance="outline">
              <mat-label>Complemento</mat-label>
              <input matInput formControlName="complemento" placeholder="Apto, Casa, etc.">
              <mat-icon matSuffix>apartment</mat-icon>
            </mat-form-field>

            <!-- Bairro -->
            <mat-form-field appearance="outline">
              <mat-label>Bairro</mat-label>
              <input matInput formControlName="bairro">
              <mat-icon matSuffix>location_city</mat-icon>
            </mat-form-field>

            <!-- Cidade -->
            <mat-form-field appearance="outline">
              <mat-label>Cidade</mat-label>
              <input matInput formControlName="cidade">
              <mat-icon matSuffix>location_on</mat-icon>
            </mat-form-field>

            <!-- Estado -->
            <mat-form-field appearance="outline">
              <mat-label>Estado</mat-label>
              <mat-select formControlName="estado">
                <mat-option value="AC">Acre</mat-option>
                <mat-option value="AL">Alagoas</mat-option>
                <mat-option value="AP">Amapá</mat-option>
                <mat-option value="AM">Amazonas</mat-option>
                <mat-option value="BA">Bahia</mat-option>
                <mat-option value="CE">Ceará</mat-option>
                <mat-option value="DF">Distrito Federal</mat-option>
                <mat-option value="ES">Espírito Santo</mat-option>
                <mat-option value="GO">Goiás</mat-option>
                <mat-option value="MA">Maranhão</mat-option>
                <mat-option value="MT">Mato Grosso</mat-option>
                <mat-option value="MS">Mato Grosso do Sul</mat-option>
                <mat-option value="MG">Minas Gerais</mat-option>
                <mat-option value="PA">Pará</mat-option>
                <mat-option value="PB">Paraíba</mat-option>
                <mat-option value="PR">Paraná</mat-option>
                <mat-option value="PE">Pernambuco</mat-option>
                <mat-option value="PI">Piauí</mat-option>
                <mat-option value="RJ">Rio de Janeiro</mat-option>
                <mat-option value="RN">Rio Grande do Norte</mat-option>
                <mat-option value="RS">Rio Grande do Sul</mat-option>
                <mat-option value="RO">Rondônia</mat-option>
                <mat-option value="RR">Roraima</mat-option>
                <mat-option value="SC">Santa Catarina</mat-option>
                <mat-option value="SP">São Paulo</mat-option>
                <mat-option value="SE">Sergipe</mat-option>
                <mat-option value="TO">Tocantins</mat-option>
              </mat-select>
              <mat-icon matSuffix>map</mat-icon>
            </mat-form-field>

            <!-- UF -->
            <mat-form-field appearance="outline">
              <mat-label>UF</mat-label>
              <input matInput formControlName="uf" maxlength="2">
              <mat-icon matSuffix>flag</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Contato -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>contact_phone</mat-icon>
            Contato
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- Email -->
            <mat-form-field appearance="outline">
              <mat-label>Email</mat-label>
              <input matInput type="email" formControlName="email">
              <mat-icon matSuffix>email</mat-icon>
              @if (form.get('email')?.invalid && form.get('email')?.touched) {
                <mat-error>{{ getErrorMessage('email') }}</mat-error>
              }
            </mat-form-field>

            <!-- Telefone -->
            <mat-form-field appearance="outline">
              <mat-label>Telefone</mat-label>
              <input matInput formControlName="telefone" placeholder="(00) 00000-0000">
              <mat-icon matSuffix>phone</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Informações Familiares -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>family_restroom</mat-icon>
            Informações Familiares
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- Nome do Pai -->
            <mat-form-field appearance="outline">
              <mat-label>Nome do Pai</mat-label>
              <input matInput formControlName="nomePai">
              <mat-icon matSuffix>person</mat-icon>
            </mat-form-field>

            <!-- Nome da Mãe -->
            <mat-form-field appearance="outline">
              <mat-label>Nome da Mãe</mat-label>
              <input matInput formControlName="nomeMae">
              <mat-icon matSuffix>person</mat-icon>
            </mat-form-field>

            <!-- Filiação Pai -->
            <mat-form-field appearance="outline">
              <mat-label>Filiação Paterna</mat-label>
              <input matInput formControlName="filiacaoPai">
              <mat-icon matSuffix>person_outline</mat-icon>
            </mat-form-field>

            <!-- Filiação Mãe -->
            <mat-form-field appearance="outline">
              <mat-label>Filiação Materna</mat-label>
              <input matInput formControlName="filiacaoMae">
              <mat-icon matSuffix>person_outline</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Informações do Karatê -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>sports_martial_arts</mat-icon>
            Informações do Karatê
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="form-grid">
            <!-- Nome do Clube -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Nome do Clube</mat-label>
              <input matInput formControlName="nomeClube">
              <mat-icon matSuffix>sports</mat-icon>
            </mat-form-field>

            <!-- Data da Faixa -->
            <mat-form-field appearance="outline">
              <mat-label>Data da Faixa</mat-label>
              <input matInput type="date" formControlName="dataFaixa">
              <mat-icon matSuffix>military_tech</mat-icon>
            </mat-form-field>

            <!-- Dia Anuidade -->
            <mat-form-field appearance="outline">
              <mat-label>Dia Anuidade</mat-label>
              <input matInput type="number" formControlName="diaAnuidade" min="1" max="31">
              <mat-icon matSuffix>calendar_today</mat-icon>
            </mat-form-field>

            <!-- Mês Anuidade -->
            <mat-form-field appearance="outline">
              <mat-label>Mês Anuidade</mat-label>
              <mat-select formControlName="mesAnuidade">
                <mat-option value="1">Janeiro</mat-option>
                <mat-option value="2">Fevereiro</mat-option>
                <mat-option value="3">Março</mat-option>
                <mat-option value="4">Abril</mat-option>
                <mat-option value="5">Maio</mat-option>
                <mat-option value="6">Junho</mat-option>
                <mat-option value="7">Julho</mat-option>
                <mat-option value="8">Agosto</mat-option>
                <mat-option value="9">Setembro</mat-option>
                <mat-option value="10">Outubro</mat-option>
                <mat-option value="11">Novembro</mat-option>
                <mat-option value="12">Dezembro</mat-option>
              </mat-select>
              <mat-icon matSuffix>date_range</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Status e Informações Adicionais -->
      <mat-card class="form-section">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>settings</mat-icon>
            Status e Informações Adicionais
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <!-- Checkboxes de Status -->
          <div class="checkbox-grid">
            <mat-checkbox formControlName="ativo">
              <mat-icon>check_circle</mat-icon>
              Ativo
            </mat-checkbox>

            <mat-checkbox formControlName="chkArbitro">
              <mat-icon>sports_martial_arts</mat-icon>
              Árbitro
            </mat-checkbox>

            <mat-checkbox formControlName="chkAvaliador">
              <mat-icon>fact_check</mat-icon>
              Avaliador
            </mat-checkbox>

            <mat-checkbox formControlName="chkArbitroCategoria">
              <mat-icon>category</mat-icon>
              Árbitro de Categoria
            </mat-checkbox>

            <mat-checkbox formControlName="pcd">
              <mat-icon>accessible</mat-icon>
              PCD
            </mat-checkbox>
          </div>

          <div class="form-grid">
            <!-- URL da Foto -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>URL da Foto</mat-label>
              <input matInput formControlName="urlFoto" placeholder="https://...">
              <mat-icon matSuffix>photo_camera</mat-icon>
            </mat-form-field>

            <!-- Observações -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Observações</mat-label>
              <textarea matInput formControlName="observacao" rows="3" placeholder="Observações gerais sobre o atleta"></textarea>
              <mat-icon matSuffix>note</mat-icon>
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>

    </form>
  }
</div>
